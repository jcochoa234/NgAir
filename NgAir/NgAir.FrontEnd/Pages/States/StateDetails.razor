@page "/states/details/{StateId:int}"

@if (State is null)
{
    <Loading />
}
else
{
    <div class="card">
        <div class="card-header">
            <span>
                <i class="bi bi-globe-americas" /> @State.Name
                <Button Type="primary" Icon="@IconType.Outline.Plus" Class="float-end" OnClick="()=>ShowModal(0, false, State.Id)">Add City</Button>&nbsp;&nbsp;&nbsp;
                <a href="/countries/details/@State.CountryId" style="padding-right:20px;">
                    <Button Type="primary" Icon="@IconType.Outline.ArrowLeft" Class="float-end" >Return</Button>
                </a>
            </span>
        </div>
        <div class="card-body">
            <Table TItem="City"
                   @ref="Table"
                   DataSource="Cities"
                   Loading="Loading"
                   Total="Total"
                   OnChange="HandleTableChange"
                   RemoteDataSource RowKey="x=>x.Id" @bind-SelectedRows="_items">
                <ChildContent>
                    <Selection />
                    <AntDesign.PropertyColumn Property="c=>c.Name" Sortable DefaultSortOrder="AntDesign.SortDirection.Ascending">
                    </AntDesign.PropertyColumn>
                    <ActionColumn Title="Action">
                        <Space>
                            <SpaceItem><Button Type="@AntDesign.ButtonType.Primary" Icon="@IconType.Outline.Edit" OnClick="()=>ShowModal(context.Id, true, 0)">Edit</Button></SpaceItem>
                            <SpaceItem><Button Danger Type="@AntDesign.ButtonType.Primary" Icon="@IconType.Outline.Delete" OnClick="()=>DeleteAsycn(context)">Remove</Button></SpaceItem>
                        </Space>
                    </ActionColumn>
                </ChildContent>
                <PaginationTemplate>
                    <AntDesign.Pagination Total="Total"
                        PageSize="context.PageSize"
                        Current="context.PageIndex"
                        ShowSizeChanger
                        OnChange="context.HandlePageChange" />
                </PaginationTemplate>
            </Table>
        </div>
    </div>
}